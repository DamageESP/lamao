!function(e){function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=1)}([function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"random",value:function(e,n){return Math.floor(n-Math.random()*(n-e))}},{key:"guid",value:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},{key:"add",value:function(){var e=document.getElementById("events");e.scrollTop=e.scrollHeight-10}},{key:"lerp",value:function(e,n,t){return t=t<0?0:t,t=t>1?1:t,e+(n-e)*t}}]),e}();e.exports=i},function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=t(2),r=t(3),l=t(4),s=t(0),a=t(5),u=t(6),d=void 0,w=void 0,c=void 0,h=window.io();window.preload=function(){d=window.loadImage("img/city.jpg"),window.bird=window.loadImage("img/bird.png")},window.setup=function(){a.setup(),window.createCanvas(window.windowWidth,window.windowHeight),w||(document.querySelector("#events").style.display="none",document.querySelector("#chat").style.display="none",document.querySelector("#login").style.display="block",document.querySelector("#username").focus())},window.draw=function(){if(window.background(d),w){u.displayKillFeed(),a.update("\n      Player pos: x-> "+Math.floor(w.pos.x)+", y-> "+Math.floor(w.pos.y)+"\n    ");var e=y.cameraPos();window.translate(e.x,e.y);for(var n=0;n<c.players.length;n++)c.players[n].display();for(var t=0;t<c.bullets.length;t++)c.bullets[t].out?c.bullets.splice(t,1):c.bullets[t].display();(window.keyIsDown(window.UP_ARROW)||window.keyIsDown(87))&&h.emit("move","up"),(window.keyIsDown(window.DOWN_ARROW)||window.keyIsDown(83))&&h.emit("move","down"),(window.keyIsDown(window.LEFT_ARROW)||window.keyIsDown(65))&&h.emit("move","left"),(window.keyIsDown(window.RIGHT_ARROW)||window.keyIsDown(68))&&h.emit("move","right")}},window.windowResized=function(){window.resizeCanvas(window.windowWidth,window.windowHeight)},window.onload=function(){document.onkeydown=function(e){y.keyDown(e.target,e.which)},document.onclick=function(e){y.mouseClick(e)},window.addEventListener("contextmenu",function(e){e.preventDefault()},!1)};var y=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"keyDown",value:function(e,n){switch(e.id){case"username":if(13==n){var t=e.value;t.length>0&&h.emit("add user",{username:t})}break;case"send":if(13==n){var o=e.value;h.emit("say",o),e.value="",e.blur()}break;case"playField":99!=n&&67!=n||a.toggle(),13==n&&document.querySelector("#send").focus()}}},{key:"mouseClick",value:function(e){switch(e.target.id){case"defaultCanvas0":0==e.button&&h.emit("shot",w.shoot())}}},{key:"cameraPos",value:function(){var e=0,n=0;return w.pos.y-window.height/2>c.playArea.y[0]&&(n=-w.pos.y+window.height/2),w.pos.x-window.width/2>c.playArea.x[0]&&(e=-w.pos.x+window.width/2),w.pos.y+window.height/2>=c.playArea.y[1]&&(n=-c.playArea.y[1]+window.height),w.pos.x+window.width/2>=c.playArea.x[1]&&(e=-c.playArea.x[1]+window.width),{x:e,y:n}}}]),e}();h.on("game update",function(e){var n=0,t=function(){c=new i(e),window.playArea=c.playArea,c.lookupId(h.id)?(w=c.lookupId(h.id),document.querySelector("#chat").style.display="block",document.querySelector("#login").style.display="none"):(w="",document.querySelector("#chat").style.display="none",document.querySelector("#login").style.display="block",document.querySelector("#username").focus())};if(e.players.length>0)for(var o=0;o<e.players.length;o++)e.players[o]=new l(e.players[o]),o==e.players.length-1&&n++,2==n&&t();else n++;if(2==n&&t(),e.bullets.length>0)for(var s=0;s<e.bullets.length;s++)e.bullets[s]=new r(e.bullets[s]),s==e.bullets.length-1&&n++,2==n&&t();else n++;2==n&&t()}),h.on("status message",function(e){var n=document.createElement("li");n.style.color="green",n.innerHTML=e,s.add()}),h.on("user message",function(e){var n=document.createElement("li");n.style.color="green",n.innerHTML=e,s.add()}),h.on("say",function(e){if("/"==e.data.charAt(0)&&e.user==w.username);else{var n=document.createElement("li");n.style.color="black",n.innerHTML="<strong style='color: "+e.colour+"'>"+e.user+"</strong>: "+e.data,document.querySelector("#events").appendChild(n),s.add()}}),h.on("add user",function(e){console.log(c,e);var n=new l(e);c.players.push(n),n.id==h.id&&(w=n,document.querySelector("#chat").style.display="block",document.querySelector("#login").style.display="none")}),h.on("shot",function(e){if(c.lookupId(e.userID)){var n=new r(e);c.bullets.push(n)}else console.log("user not found when trying to shoot")}),h.on("player kill",function(e){u.killFeed||(u.killFeed=[]),4==u.killFeed.length&&u.killFeed.shift(),u.killFeed.push(e)}),h.on("disconnected",function(e){var n=c.lookupId(e);w==n&&(w="",document.querySelector("#chat").style.display="none",document.querySelector("#login").style.display="block");var t=c.players.indexOf(n);c.players.splice(t,1)})},function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=n.id,this.players=n.players||[],this.bullets=n.bullets||[],this.playArea=n.playArea,this.playerLimit=64}return o(e,[{key:"lookup",value:function(e){for(var n={},t=0,o=this.players.length;t<o;t++)n[this.players[t].username.toLowerCase()]=this.players[t];return!!n[e]&&n[e]}},{key:"lookupId",value:function(e){for(var n={},t=0,o=this.players.length;t<o;t++)n[this.players[t].id]=this.players[t];return!!n[e]&&n[e]}}]),e}();e.exports=i},function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.userID=n.userID,this.id=n.id,this.pos=n.pos,this.heading={x:n.heading.x*(n.range||16),y:n.heading.y*(n.range||16)},this.decay=n.decay||0,this.strength=n.strength||40,this.out=n.out}return o(e,[{key:"fly",value:function(){this.strength>0?this.strength-=.5:this.strength=0,this.decay+=.003,this.heading.y+=this.decay,this.pos.x+=this.heading.x,this.pos.y+=this.heading.y}},{key:"display",value:function(){window.push(),window.fill(255),window.strokeWeight(5),window.point(this.pos.x,this.pos.y),window.pop()}}]),e}();e.exports=i},function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=t(0),r=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=n.id,this.username=n.username,this.colour=n.colour,this.speed={x:0,y:0},this.pos=n.pos,this.kills=n.kills||0,this.size=n.size||30,this.health=n.health||100}return o(e,[{key:"shoot",value:function(){var e=window.createVector(window.mouseX,window.mouseY).sub(this.playerScreenPos()).heading();return e=window.p5.Vector.fromAngle(e),{pos:{x:this.pos.x,y:this.pos.y},heading:{x:e.x,y:e.y}}}},{key:"display",value:function(){this.pos=window.createVector(this.pos.x,this.pos.y);var e=window.color(this.colour.r,this.colour.g,this.colour.b),n=window.createVector(window.mouseX,window.mouseY).sub(this.playerScreenPos()).heading(),t=window.createVector(this.size/100,this.size/100);window.push(),window.translate(this.pos.x,this.pos.y),window.rotate(n,this.pos),window.scale(t),window.image(window.bird,-window.bird.width/2,-window.bird.height/2,window.bird.width,window.bird.height),window.pop(),window.push(),window.textAlign(window.CENTER),window.fill(e),window.stroke(0),window.strokeWeight(3),window.textStyle(window.BOLD),window.text(this.username+" ("+this.health+")",this.pos.x,this.pos.y-window.bird.height/1.5),window.pop()}},{key:"playerScreenPos",value:function(){var e=window.createVector(this.pos.x,this.pos.y);return this.pos.x-window.playArea.x[0]>=window.width/2&&(e.x=this.pos.x-Math.abs(window.playArea.x[0]-(this.pos.x-window.width/2))),window.playArea.x[1]-this.pos.x<window.width/2&&(e.x=window.width-(window.playArea.x[1]-this.pos.x)),this.pos.y-window.playArea.y[0]>=window.height/2&&(e.y=this.pos.y-Math.abs(window.playArea.y[0]-(this.pos.y-window.height/2))),window.playArea.y[1]-this.pos.y<window.height/2&&(e.y=window.height-(window.playArea.y[1]-this.pos.y)),e}},{key:"move",value:function(e){var n={x:0,y:0},t={x:this.pos.x,y:this.pos.y};return"up"===e&&(n={x:0,y:-10}),"down"===e&&(n={x:0,y:10}),"left"===e&&(n={x:-10,y:0}),"right"===e&&(n={x:10,y:0}),this.speed.x=i.lerp(this.speed.x,n.x,.02),this.speed.y=i.lerp(this.speed.y,n.y,.02),t.x+=this.speed.x,t.y+=this.speed.y,t}}]),e}();e.exports=r},function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"setup",value:function(){var e=document.createElement("div");e.id="console",e.style.cssText="width: 500px; height: 100%; background: white; right: 0; top: 0; position: absolute; padding: 25px; display: none;",document.getElementsByTagName("body")[0].appendChild(e)}},{key:"update",value:function(e){"block"==document.getElementById("console").style.display&&(document.getElementById("console").innerHTML=e)}},{key:"toggle",value:function(){"none"==document.getElementById("console").style.display?document.getElementById("console").style.display="block":document.getElementById("console").style.display="none"}}]),e}();e.exports=i},function(e,n,t){"use strict";var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),i=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"displayKillFeed",value:function(){if(!this.killFeed)return!1;var e={position:{x:window.width-300,y:100},width:300,height:100};window.push(),window.translate(e.position.x,e.position.y);for(var n=this.killFeed.length-1;n>=0;n--)15*(this.killFeed.length-n)<=e.height&&(window.textSize(16),window.strokeWeight(2),window.stroke(0),window.textStyle(window.BOLD),window.fill(this.killFeed[n].killer.colour.r,this.killFeed[n].killer.colour.g,this.killFeed[n].killer.colour.b),window.text(this.killFeed[n].killer.username,15,15*-(this.killFeed.length-n),e.width-15,e.height-15),window.textStyle(window.NORMAL),window.fill(0),window.noStroke(),window.text(" killed",17+window.textWidth(this.killFeed[n].killer.username),15*-(this.killFeed.length-n),e.width-15,e.height-15),window.fill(this.killFeed[n].killed.colour.r,this.killFeed[n].killed.colour.g,this.killFeed[n].killed.colour.b),window.stroke(0),window.textStyle(window.BOLD),window.text(this.killFeed[n].killed.username,17+window.textWidth(this.killFeed[n].killer.username+" killed"),15*-(this.killFeed.length-n),e.width-15,e.height-15));window.pop()}}]),e}();e.exports=i}]);